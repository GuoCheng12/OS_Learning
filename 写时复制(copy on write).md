# 写时复制(copy on write)

  在Linux程序中，**fork**()会产生一个和父进程完全相同的子进程，但子进程在此后多会**exec**系统调用，出于效率考虑，linux中引入了“**写时复制COW**“技术，也就是只有进程空间的各段的**内容**(即写) 要发生变化时，才会将父进程的内容复制一份给子进程。

在**fork之后exec之前**两个进程用的是相同的**物理空间（内存区）**，子进程的代码段、数据段、堆栈都是指向父进程的物理空间，也就是说，两者的虚拟空间不同，但其对应的物理空间是相同的同一个。当父子进程中有更改相应段的行为发生时，**再为子进程相应的段分配物理空间**，如果不是因为**exec**，内核会给子进程的数据段、堆栈段分配相应的物理空间（至此两者有各自的进程空间，互不影响），而代码段继续共享父进程的物理空间（两者的代码完全相同）。而如果是因为exec，由于两者执行的代码不同，子进程的代码段也会分配单独的物理空间。  